{% extends "base.html" %}

{% block content %}
<!-- If the day of the week is Mon - Friday until 22:00 show the competition entry form. -->
{% if (datetime.strftime("%w") == "0") or (datetime.strftime("%w") == "2") or (datetime.strftime("%w") == "3") or (datetime.strftime("%w") == "4") or ((datetime.strftime("%w") == "5") and (datetime.strftime("%H") <= "22") ) %}
<section class="comp-intro center-align">
    <div class="row">
        <div class="col s10 offset-s1">
            <h1 class="page-heading">Compete</h1>

            <h2 class="grey-text text-lighten-4 page-subheading">This week's theme is {{category|capitalize}}</h2>

            <h5 class="grey-text text-lighten-4 page-sub-subheading-text">{{instructions}}</h5>
        </div>
    </div>
</section>
<div class="row">
    <ul class="collapsible">
        <li class="col s12 m10 offset-m1">
            <div class="collapsible-header add-photo-collapsible-header valign-wrapper">
                <i class="fas fa-plus center-align"></i><p class="center-align add-a-photo-text">Add a Photo!</p>
            </div>
            <div class="collapsible-body">
                <form class="col s12 m12" method="post" action="{{ url_for('compete') }}"
                    enctype="multipart/form-data">
                    <div class="row">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <div class="input-field col s12 m6">
                            <input id="title" name="title" type="text" class="validate" required>
                            <label for="title">Title</label>
                        </div>
                        <div class="file-field input-field col s12 m6">
                            <div class="btn">
                                <span>Upload Photo</span>
                                <input type="file" name="photo">
                            </div>
                            <div class="file-path-wrapper">
                                <input class="file-path validate" type="text">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                            <textarea id="story" name="story" class="materialize-textarea"></textarea>
                            <label for="story">Story</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12 m6">
                            <input id="camera" name="camera" type="text" class="validate" required>
                            <label for="camera">Camera</label>
                        </div>
                        <div class="input-field col s12 m6">
                            <input id="lens" name="lens" type="text" class="validate">
                            <label for="lens">Lens</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12 m4">
                            <input id="aperture" name="aperture" type="text" class="validate">
                            <label for="aperture">Aperture</label>
                        </div>
                        <div class="input-field col s12 m4">
                            <input id="shutter" name="shutter" type="text" class="validate">
                            <label for="shutter">Shutter Speed</label>
                        </div>
                        <div class="input-field col s12 m4 white-text">
                            <input id="iso" name="iso" type="text" class="validate">
                            <label for="iso">ISO</label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col s12">
                            <p class="grey-text terms-and-conditions">I confirm that this photograph is my own original creation and I have the right to
                                share and distribute it. I certify that this photograph does not violate the rights of any third party or
                                any copyright. I understand that I am prohibited from entering sexual imagery, violent imagery or
                                any images that might be deemed offensive. I also confirm that this photo has not been heavily edited with the
                                only allowed exception being some simple tweaks to contrast, exposure and white-balance. In submitting this image I agree 
                                to grant SNAPATHON the free of charge right to use and distribute this photograph in any manner and using any media, including
                                and without limitation, the right to distribute, publish, adapt, display and copy the image.<br><br>
                                <label> <input type="checkbox" class="filled-in checkbox-yellow" required />
                                    <span>I have read and agree to these terms and conditions</span>
                                </label></p>
                        </div>
                    </div>
                    <button class="btn waves-effect waves-light compete-form-btn" type="submit" name="action">Compete!
                    </button>
                </form>

            </div>
        </li>
        <li class="col s12 m10 offset-m1">
            <div class="collapsible-header valign-wrapper review-rules-collapsible-header"><i class="far fa-list-alt"></i><p class="review-rules-text">Review the competition rules</p></div>
            <div class="collapsible-body competition-rules">
                <div class="row">
                <h3 class="center-align rules-heading">The rules are as follows:</h3>
                <ul class="rules col s12 m10 offset-m1">
                    <li>As a member you may enter 1 photograph into each weekly competition.</li>
                    <li>The photograph must be your own original creation.</li>
                    <li>The photograph must not depict anything of a violent, sexual or offensive nature.</li>
                    <li>The photograph must not be heavily edited. Only light retouching of exposure, contrast & white-balance is permitted.</li>
                    <li>The photograph must not violate the rights of any third party.</li>
                    <li>The photograph must not breach copyright law.</li>
                    <li>Entries are accepted through our online form (above) each week from 0:00AM Monday until 22:00PM Friday.</li>
                    <li>Voting takes place from 22:00PM Friday until 22:00PM Sunday.</li>
                    <li>Winners are announced on the "Recent Winners" page and all points & awards are automatically assigned.</li>
                    <li>If you enter a photograph into competition, you MUST vote for 1 photograph (not your own).</li>
                    <li>If you fail to vote between Friday after 22:00PM and Sunday at 22:00, your entry will be nullified and its points/votes set to 0.</li>
                    <li>All times quoted are UTC+00:00</li>
                </ul>
                </div>

            </div>
        </li>
    </ul>
    </div>
    {% else %}
            <section class="comp-intro center-align">
            <div class="row">
                <div class="col s8 offset-s2">
                    <h1 class="grey-text text-lighten-4">VOTE</h1>

                    <h2 class="grey-text text-lighten-4">This week's theme is Portraiture</h2>

                    <h5 class="grey-text text-lighten-4">Vote for your favourite entries now! Obviously you cannot vote for your own image. 
                        If you do not vote by 22:00PM on Sunday evening UTC, your entry's points will be nullified. Winning images & users will be announced Sunday night when voting 
                        closes. 
                    </h5>
                </div>
            </div>
        </section>
    

    <div id="entries" class="row s12">
       
        {% for photo in this_weeks_entries %}

        <div class="col s12 m4 l3 profile-photos-col">
            <a href="{{ url_for('get_photo', filename=photo.filename )}}"><img class="thumbnail-photo" src="{{ url_for('file', filename=photo.filename) }}" alt="f"/>
        </a>
        <div class="vote-container">
        <form action="{{ url_for('vote', filename=photo.filename) }}" method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <button class="btn-large vote-button" type="submit" value="Submit"><i class="fas fa-vote-yea vote-icon"></i>Vote for this image</button>
        </form>
        </div>
        </div>

        {% endfor %}
    </div>
    {% endif %}



{% endblock %}